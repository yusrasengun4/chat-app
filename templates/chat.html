{% extends "base.html" %}
{% block title %}Sohbet{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6 h-screen">
  <div class="grid grid-cols-12 gap-4 h-full">

    <!-- SOL PANEL: Kullanıcılar ve Gruplar -->
    <div class="col-span-3 bg-white rounded-lg shadow-lg flex flex-col">
      <div class="bg-blue-600 text-white p-4 rounded-t-lg">
        <h2 class="text-xl font-bold"><i class="fas fa-comments"></i> Sohbetler</h2>
      </div>

      <div class="flex-1 overflow-y-auto p-4 space-y-4">
        <!-- Kullanıcılar -->
        <div>
          <h3 class="text-lg font-semibold mb-2">Kullanıcılar</h3>
          <div id="users-list" class="space-y-2"></div>
        </div>

        <!-- Gruplar -->
        <div class="mt-6">
          <h3 class="text-lg font-semibold mb-2 flex justify-between items-center">
            Gruplar
            <button id="create-group-btn" class="bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 text-sm">
              ➕ Yeni Grup
            </button>
          </h3>
          <div id="groups-list" class="space-y-2"></div>
        </div>

        <!-- Broadcast -->
        <button id="broadcast-btn" class="mt-6 w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">
          📡 Herkese Mesaj
        </button>
      </div>
    </div>

    <!-- SAĞ PANEL: Mesajlar -->
    <div class="col-span-9 bg-white rounded-lg shadow-lg flex flex-col">
      <!-- Başlık -->
      <div class="bg-blue-600 text-white p-4 rounded-t-lg flex justify-between items-center">
        <div>
          <h2 id="chat-title" class="text-xl font-bold"><i class="fas fa-comment-dots"></i> Sohbet Seçin</h2>
          <p id="chat-subtitle" class="text-sm text-blue-200"></p>
        </div>
      </div>

      <!-- Mesajlar -->
      <div id="messages" class="flex-1 p-4 bg-gray-50 overflow-y-auto">
        <div class="text-center text-gray-500 mt-20">
          <i class="fas fa-comments text-6xl mb-4"></i>
          <p class="text-lg">Sohbet başlatmak için bir kullanıcı veya grup seçin</p>
        </div>
      </div>

      <!-- Mesaj Gönderme -->
      <div class="p-4 border-t bg-white rounded-b-lg">
        <form id="message-form" class="flex space-x-2">
          <input id="message-input" type="text" placeholder="Mesajınızı yazın..."
                 class="flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" disabled>
          <button id="send-btn" type="submit"
                  class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition disabled:bg-gray-400"
                  disabled>
            <i class="fas fa-paper-plane"></i> Gönder
          </button>
        </form>
      </div>
    </div>

  </div>
</div>

<!-- Grup Oluşturma Modal -->
<div id="group-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white p-6 rounded-lg shadow-xl w-80">
    <h3 class="text-lg font-semibold mb-3">Yeni Grup Oluştur</h3>
    <form id="create-group-form">
      <input type="text" id="group-name" placeholder="Grup Adı" required
             class="border rounded w-full p-2 mb-2">
      <textarea id="group-description" placeholder="Açıklama (isteğe bağlı)"
                class="border rounded w-full p-2 mb-2"></textarea>
      <div class="flex justify-end gap-2">
        <button type="button" id="cancel-group-btn"
                class="bg-gray-300 px-3 py-1 rounded hover:bg-gray-400">İptal</button>
        <button type="submit"
                class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600">Oluştur</button>
      </div>
    </form>
  </div>
</div>

<!-- JS dosyası -->
<script src="{{ url_for('static', filename='js/chat.js') }}"></script>
{% endblock %}
